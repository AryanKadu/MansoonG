<%- include('../_layouts/header') %>

<div class="container">
  <h2>All Orders for <%= user.name %> (<%= user.email %>)</h2>

  <table class="table">
    <thead>
      <tr>
        <th>#</th>
        <th>Products</th>
        <th>Total</th>
        <th>Paid</th>
        <th>Remaining</th>
        <th>Date</th>
      </tr>
    </thead>
    <tbody>
      <% orders.forEach((order, index) => { %>
        <tr>
          <td><%= index + 1 %></td>
          <td>
            <% order.items.forEach(item => { %>
                      <% if (item.product) { %>
                        <span class="badge bg-light border text-dark me-1 mb-1 d-inline-block">
                          <%= item.product.title %> × <%= item.quantity %>
                        </span>
                      <% } %>
                        
                  <% }) %>
          </td>
          <td>₹<%= order.totalAmount %></td>
          <td>₹<%= order.paidAmount %></td>
          <td>₹<%= order.totalAmount - order.paidAmount %></td>
          <td><%= order.createdAt.toLocaleDateString('en-IN') %></td>
          <td>
            <a href="/admin/orders/<%= order._id %>" class="btn btn-sm btn-primary">Details</a>
          </td>
        </tr>
      <% }) %>
    </tbody>
  </table>

  <a href="/admin/dashboard" class="btn btn-secondary">Back to Dashboard</a>
</div>

<%- include('../_layouts/footer') %>
